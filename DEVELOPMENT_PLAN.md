# GWS-Auto-for-Android: 開発計画書

このドキュメントは、開発計画をフェーズごとに分割して記したものです。各タスクは、GitHubのIssueとして登録されることを想定しています。

---

### フェーズ1: アプリケーション基盤とユーザー認証

**目標:** アプリケーションの基本的な骨格を構築し、ユーザー認証を実装し、データベースの構造をセットアップする。

- [x] **Task:** 3つのタブ（ワークフロー、トリガー、設定）を持つボトムナビゲーションバーを実装する。
- [x] **Task:** Firebase Authenticationを使用し、Googleサインインによるユーザー認証を実装する。
- [x] **Task:** 認証状態を管理し、ユーザーをリダイレクトするためのスプラッシュスクリーンを作成する。
- [x] **(frontend)** **Task:** メイン画面用の基本的なアプリ内ナビゲーションを`NavHost`でセットアップする。
- [x] **Task:** ユーザープロファイルと設定情報を保存するための、Firestoreの基本データベース構造を定義する。
- [x] **Task:** 「サインアウト」ボタンを含む、基本的な「設定」画面のUIを実装する。
- [x] **Task:** アプリケーションの基本的なMaterial 3テーマ（色、タイポグラフィ）をセットアップする。
- [x] **Task:** 起動時の強制ログインを廃止し、アプリ内部（設定画面）から任意にログイン/ログアウトできるように再配置する。

---

### フェーズ2: コア・ワークフローエンジン

**目標:** ワークフロー、モジュール、トリガーのデータモデルを定義し、一連のアクションを実行するためのコアロジックを実装する。

- [x] **Task:** `Workflow`、`Module`、`Trigger`のデータモデルをKotlinのdata classとして定義する。
- [x] **Task:** モジュールのリストを順次実行できる、コア・ワークフロー実行エンジンを実装する。
- [x] **Task:** エンジンテスト用のシンプルな「ダミー」モジュールを2つ作成する（例：「トースト表示」モジュール、「ログ出力」モジュール）。
- [x] **Task:** `Workflows`と`Triggers`を保存するためのFirestoreデータベース構造を定義する。
- [x] **Task:** Firestoreからワークフローデータを保存・取得するための`WorkflowRepository`クラスを作成する。

---

### フェーズ3: ワークフロー作成UI

**目標:** ユーザーがワークフローを作成、表示、管理するためのユーザーインターフェースを構築する。

- [x] **Task:** Firestoreからユーザーの保存済みワークフローの一覧を取得し、「ワークフロー」メイン画面に表示する。
- [x] **Task:** ワークフロー画面に「新規ワークフロー作成」ボタン（例: FAB）を設置する。
- [x] **(frontend)** **Task:** ユーザーがリストからモジュールを追加できる、ワークフローエディタ画面のUIを設計する。
- [x] **(frontend)** **Task:** ワークフローエディタ内で、モジュールの並べ替えと削除を可能にする。
- [x] **Task:** エディタで構築されたワークフローをFirestoreに保存するロジックを実装する。

---

### フェーズ4: GWS連携とモジュール開発

**目標:** Google Workspace APIと連携し、実用的なGWSモジュールの第一弾を開発する。

- [x] **Task:** Google APIクライアントをセットアップし、GWSアクセスに必要なOAuth2トークンスコープを処理する。
- [x] **Task:** Google Sheets APIとDrive APIを連携させ、「スプレッドシートからPDF生成」モジュールを開発する。
- [x] **(frontend)** **Task:** モジュールのパラメータ（例: URLのテキスト入力、Driveのファイル選択）を設定するための汎用的なUIを作成する。
- [x] **Task:** Google Drive APIと連携させ、「Excelをスプレッドシートに変換」モジュールを開発する。
- [x] **Task:** ユーザーが各モジュールのパラメータを設定できるように、ワークフローエディタを拡張する。

---

### フェーズ5: トリガーとスケジューリング

**目標:** スケジュールに基づいてワークフローを自動実行する機能を実装する。

- [ ] **Task:** `WorkManager`を使用して、信頼性の高いバックグラウンド実行のためのスケジューリングロジックを実装する。
- [ ] **Task:** スケジュールされたトリガーの一覧を表示する「トリガー」画面のUIを作成する。
- [ ] **Task:** トリガー（時間指定、繰り返しなど）を作成・編集するためのUIを実装する。
- [ ] **Task:** スケジュールされた時間に、対応するワークフローを呼び出すトリガーハンドラを開発する。
- [ ] **Task:** [発展目標] トリガーのスケジュールを視覚化するためのカレンダービューを実装する。

---

### フェーズ6: 高度な機能と仕上げ

**目標:** READMEに記載された残りの高度な機能を実装し、アプリケーションを洗練させる。

- [x] **Task:** ビルドエラーを修正し、Firebase App Distributionへの手動テスト配布ワークフローを構築する。
- [ ] **Task:** 手動実行ワークフローのショートカットをAndroidのホーム画面に作成する機能を実装する。
- [ ] **Task:** 「シークレットキー」を安全に保存・取得する仕組みを実装する。
- [ ] **Task:** シークレットキーを管理（追加、編集、削除）するためのUIを作成する。
- [ ] **Task:** 条件分岐（"If/Else"）など、複雑なワークフローロジックを実装する。
- [ ] **Task:** アプリ全体のUI/UXレビューを実施し、最終的な磨き込みを行う。
- [ ] **Task:** アプリ全体に、包括的なエラーハンドリングとユーザーフィードバックの仕組みを追加する。

---

### フェーズ7: UI基盤の強化とデザインシステム導入 (Web版準拠)

**目標:** Webアプリ版の技術仕様書に基づき、AndroidアプリのUIテーマとコンポーネントスタイルを統一し、一貫性のあるモダンなデザイン基盤を構築する。

- [ ] **Task:** カラーテーマの適用: 技術仕様書のカラーパレット (`Primary`, `Background`, `Card`等) を、`res/values/colors.xml`とMaterial 3テーマに反映させる。
- [ ] **Task:** タイポグラフィの適用: `PT Sans`と`Noto Sans JP`フォントをプロジェクトに追加し、`TextView`や`Button`のデフォルトスタイルとして適用する。
- [ ] **Task:** `MaterialCardView`の共通スタイルを定義し、Web版の`Card`コンポーネントのような見た目（角丸、影、余白）に統一する。
- [ ] **Task:** `Chip`コンポーネントのスタイルを定義し、ステータス表示（`アクティブ`, `エラー`など）に使えるように準備する。

---

### フェーズ8: 主要画面のUI実装 (Web版準拠)

**目標:** 「ワークフロー」「トリガー」「設定」の各主要画面を、技術仕様書の設計に基づいて具体的に実装し、ユーザー体験を向上させる。

- [x] **Task (Workflow):** `fragment_workflow.xml`にタイトルを追加し、`RecyclerView`と`FloatingActionButton`の基本レイアウトを構築する。
- [x] **Task (Workflow):** `list_item_workflow.xml`を作成し、`MaterialCardView`をベースにしたカードUIの骨格を実装する。
- [ ] **Task (Workflow):** `WorkflowAdapter`をリファクタリングし、実際の`Workflow`オブジェクトのデータ（名前、トリガー、ステータス）をカードUIにバインドする。
- [ ] **Task (Trigger):** `fragment_trigger.xml`のUIを設計する。技術仕様書の「縦型タイムライン」を参考に、`RecyclerView`を使ったレイアウトを構築する。
- [ ] **Task (Settings):** `fragment_settings.xml`のUIを再設計する。技術仕様書に基づき、`TabLayout`を使って「テーマ」「言語」「カレンダー」などの設定項目を分類する。
- [ ] **Task (Settings):** テーマ設定（ライト/ダーク）機能を`Tabs`コンポーネントを使って実装する。
- [ ] **Task (Settings):** 言語設定機能を`Spinner`または`ExposedDropdownMenu`を使って実装する。

---

### フェーズ9: デバッグと開発環境の整備

**目標:** `開発環境まとめ.txt`に記載された、効率的なハイブリッド開発体制を完成させる。

- [x] **Task:** `Timber`を導入し、Logcatへのログ出力基盤を構築する。
- [x] **Task:** `FileLoggingTree`を実装し、Logcatと同時に`debug.log`ファイルへログを書き出す仕組みを構築する。
- [ ] **Task:** アプリ内の主要な処理（画面遷移、データ取得、ボタンクリックなど）に、`Timber`によるデバッグログを適切に配置する。
