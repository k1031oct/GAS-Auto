# GWS-Auto-for-Android: 開発計画書

このドキュメントは、開発計画をフェーズごとに分割して記したものです。各タスクは、GitHubのIssueとして登録されることを想定しています。

---

### フェーズ1: アプリケーション基盤とユーザー認証

**目標:** アプリケーションの基本的な骨格を構築し、ユーザー認証を実装し、データベースの構造をセットアップする。

- [ ] **Task:** 3つのタブ（ワークフロー、トリガー、設定）を持つボトムナビゲーションバーを実装する。
- [ ] **Task:** Firebase Authenticationを使用し、Googleサインインによるユーザー認証を実装する。
- [ ] **Task:** 認証状態を管理し、ユーザーをリダイレクトするためのスプラッシュスクリーンを作成する。
- [(frontend)] **Task:** メイン画面用の基本的なアプリ内ナビゲーションを`NavHost`でセットアップする。
- [ ] **Task:** ユーザープロファイルと設定情報を保存するための、Firestoreの基本データベース構造を定義する。
- [ ] **Task:** 「サインアウト」ボタンを含む、基本的な「設定」画面のUIを実装する。
- [ ] **Task:** アプリケーションの基本的なMaterial 3テーマ（色、タイポグラフィ）をセットアップする。

---

### フェーズ2: コア・ワークフローエンジン

**目標:** ワークフロー、モジュール、トリガーのデータモデルを定義し、一連のアクションを実行するためのコアロジックを実装する。

- [ ] **Task:** `Workflow`、`Module`、`Trigger`のデータモデルをKotlinのdata classとして定義する。
- [ ] **Task:** モジュールのリストを順次実行できる、コア・ワークフロー実行エンジンを実装する。
- [ ] **Task:** エンジンテスト用のシンプルな「ダミー」モジュールを2つ作成する（例：「トースト表示」モジュール、「ログ出力」モジュール）。
- [ ] **Task:** `Workflows`と`Triggers`を保存するためのFirestoreデータベース構造を定義する。
- [ ] **Task:** Firestoreからワークフローデータを保存・取得するための`WorkflowRepository`クラスを作成する。

---

### フェーズ3: ワークフロー作成UI

**目標:** ユーザーがワークフローを作成、表示、管理するためのユーザーインターフェースを構築する。

- [ ] **Task:** Firestoreからユーザーの保存済みワークフローの一覧を取得し、「ワークフロー」メイン画面に表示する。
- [ ] **Task:** ワークフロー画面に「新規ワークフロー作成」ボタン（例: FAB）を設置する。
- [(frontend)] **Task:** ユーザーがリストからモジュールを追加できる、ワークフローエディタ画面のUIを設計する。
- [(frontend)] **Task:** ワークフローエディタ内で、モジュールの並べ替えと削除を可能にする。
- [ ] **Task:** エディタで構築されたワークフローをFirestoreに保存するロジックを実装する。

---

### フェーズ4: GWS連携とモジュール開発

**目標:** Google Workspace APIと連携し、実用的なGWSモジュールの第一弾を開発する。

- [ ] **Task:** Google APIクライアントをセットアップし、GWSアクセスに必要なOAuth2トークンスコープを処理する。
- [ ] **Task:** Google Sheets APIとDrive APIを連携させ、「スプレッドシートからPDF生成」モジュールを開発する。
- [(frontend)] **Task:** モジュールのパラメータ（例: URLのテキスト入力、Driveのファイル選択）を設定するための汎用的なUIを作成する。
- [ ] **Task:** Google Drive APIと連携させ、「Excelをスプレッドシートに変換」モジュールを開発する。
- [ ] **Task:** ユーザーが各モジュールのパラメータを設定できるように、ワークフローエディタを拡張する。

---

### フェーズ5: トリガーとスケジューリング

**目標:** スケジュールに基づいてワークフローを自動実行する機能を実装する。

- [ ] **Task:** `WorkManager`を使用して、信頼性の高いバックグラウンド実行のためのスケジューリングロジックを実装する。
- [(frontend)] **Task:** スケジュールされたトリガーの一覧を表示する「トリガー」画面のUIを作成する。
- [(frontend)] **Task:** トリガー（時間指定、繰り返しなど）を作成・編集するためのUIを実装する。
- [ ] **Task:** スケジュールされた時間に、対応するワークフローを呼び出すトリガーハンドラを開発する。
- [(frontend)] **Task:** [発展目標] トリガーのスケジュールを視覚化するためのカレンダービューを実装する。

---

### フェーズ6: 高度な機能と仕上げ

**目標:** READMEに記載された残りの高度な機能を実装し、アプリケーションを洗練させる。

- [ ] **Task:** 手動実行ワークフローのショートカットをAndroidのホーム画面に作成する機能を実装する。
- [ ] **Task:** 「シークレットキー」を安全に保存・取得する仕組みを実装する。
- [(frontend)] **Task:** シークレットキーを管理（追加、編集、削除）するためのUIを作成する。
- [ ] **Task:** 条件分岐（"If/Else"）など、複雑なワークフローロジックを実装する。
- [ ] **Task:** アプリ全体のUI/UXレビューを実施し、最終的な磨き込みを行う。
- [ ] **Task:** アプリ全体に、包括的なエラーハンドリングとユーザーフィードバックの仕組みを追加する。
